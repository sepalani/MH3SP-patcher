<wiidisc version="1">
    <id game="RMH" developer="08" />

    <options>
        <section name="Private Server">
            <option name="Patch NAS server" default="1">
                <choice name="Enabled">
                    <patch id="patch-nas" />
                </choice>
            </option>
            <option name="Patch GameSpy HTTPS" default="1">
                <choice name="Enabled">
                    <patch id="patch-gs" />
                </choice>
            </option>
            <option name="Patch certificate" default="1">
                <choice name="Enabled">
                    <patch id="patch-cert" />
                </choice>
            </option>
            <option name="Patch EC check" default="0">
                <choice name="Enabled">
                    <patch id="patch-ec" />
                </choice>
            </option>
        </section>
    </options>

    <!-- Patch NAS requests: /ac and /pr -->
    <patch id="patch-nas">
        <memory original="68747470733A2F2F6E61737769692E6E696E74656E646F776966692E6E65742F6163"
                value="687474703A2F2F6E61737769692E6E696E74656E646F776966692E6E65742F616300"
                align="4" search="true" />
        <memory original="68747470733A2F2F6E61737769692E6E696E74656E646F776966692E6E65742F7072"
                value="687474703A2F2F6E61737769692E6E696E74656E646F776966692E6E65742F707200"
                align="4" search="true" />
    </patch>

    <!-- SSL strip GameSpy HTTPS requests -->
    <patch id="patch-gs">
        <memory original="68747470733A00"
                value="687474703A0000" align="4" search="true" />
        <memory original="68747470733A2F2F00"
                value="687474703A2F2F0000" align="4" search="true" />
    </patch>

    <!-- Replace the SSL-pinned certificate -->
    <patch id="patch-cert">
        <memory original="3082039830820301A003020102020101300D06092A864886F70D0101050500308195310B3009060355040613025553311330110603550408130A57617368696E67746F6E3121301F060355040A13184E696E74656E646F206F6620416D657269636120496E632E310C300A060355040B13034E4F41311C301A060355040313134E696E74656E646F20436C61737320322043413122302006092A864886F70D01090116136361406E6F612E6E696E74656E646F2E636F6D301E170D3037303631353139333433335A170D3439313232383132303030305A308195310B3009060355040613025553311330110603550408130A57617368696E67746F6E3121301F060355040A13184E696E74656E646F206F6620416D657269636120496E632E310C300A060355040B13034E4F41311C301A060355040313134E696E74656E646F20436C61737320322043413122302006092A864886F70D01090116136361406E6F612E6E696E74656E646F2E636F6D30819F300D06092A864886F70D010101050003818D0030818902818100B4A80FE38002A7ADFB599DE1929D197B620096CE132E5B83C03326A63934AC8EE77F697ED4C07CB76086AFB6450636E45DEAED1554361D57B69E0E07436210EE35C2413438D0DD52AE86FD0C9D29FA3EB6BBD95138262487A220374E8EBCD1045B98187EA854FDD0BFA61B480EE619B4DFC43F8A19CEA01423B147122C1E8CA70203010001A381F53081F2301D0603551D0E04160414CB40167CB1372B265A35DEBEF15B508A8D0CD4BD3081C20603551D230481BA3081B78014CB40167CB1372B265A35DEBEF15B508A8D0CD4BDA1819BA48198308195310B3009060355040613025553311330110603550408130A57617368696E67746F6E3121301F060355040A13184E696E74656E646F206F6620416D657269636120496E632E310C300A060355040B13034E4F41311C301A060355040313134E696E74656E646F20436C61737320322043413122302006092A864886F70D01090116136361406E6F612E6E696E74656E646F2E636F6D820101300C0603551D13040530030101FF300D06092A864886F70D0101050500038181009C8751C1E22699C697013F5E89D9062806B5A6C9A46FEAFEB2A88A19082AA9D321B9CAFFD010E3455465181EBA96346DDB0DAE7A164BAD4BA33A44AE78732470ADC74E5A6371566E455A635309C2CF9148233F43C16C9D7844936640D883C398E3C9839D62BC3884468345267C2774253BB30366D4D619FE76D8D96A991C60E7"
                valuefile ="mh3sp/ca.der" align="4" search="true" />
    </patch>

    <!-- Patch Wii Shop check -->
    <patch id="patch-ec">
        <memory original="806DBDB02C030000418200084BFFB5FC386000004E800020"
                value="60000000600000006000000060000000386000014E800020" align="4" search="true" />
        <memory original="806DBDB02C030000418200084BFFB5EC386000004E800020"
                value="60000000600000006000000060000000386000014E800020" align="4" search="true" />
        <memory original="9421FFD07C0802A690010034396100304BF722F9"
                value="600000006000000060000000386000004E800020" align="4" search="true" />
        <memory original="9421FFC07C0802A690010044396100404BF720FD"
                value="600000006000000060000000386000004E800020" align="4" search="true" />
        <memory original="9421FFF07C0802A63C608082900100148083B6A02C040000"
                value="60000000600000006000000060000000386000004E800020" align="4" search="true" />
    </patch>
</wiidisc>
